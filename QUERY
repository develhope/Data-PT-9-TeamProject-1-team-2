-- Selezione dati demografici dei giocatori
WITH Demographics AS (
SELECT PlayerID, Age, Gender, Location
FROM game),
--Selezione informazioni comportamentali
Behavior AS (SELECT PlayerID, PlayTimeHours, AvgSessionDurationMinutes, SessionsPerWeek
FROM game),
-- Selezione statistiche di gioco
Stats  AS (SELECT PlayerID, PlayerLevel, AchievementsUnlocked
FROM game),
-- Selezione dati relativi al tasso di partecipazione e acquisti in game
Rate AS (SELECT PlayerID, InGamePurchases, EngagementLevel, GameGenre, GameDifficulty 
FROM game)
--Confronto tra i dati indicati per evidenziare la correlazione tra gli acquisti, la durata media di gioco, l'et√† e gli achievement sbloccati
SELECT b.PlayerID, s.AchievementsUnlocked , b.AvgSessionDurationMinutes, d.Age, r.IngamePurchases
FROM Behavior b 
JOIN Stats s on b.PlayerID = s.PlayerID
JOIN Demographics d on b.PlayerID = d.PlayerID
JOIN Rate r on b.PlayerID = r.PlayerID
ORDER BY s.AchievementsUnlocked DESC, r.InGamePurchases DESC;



SELECT
  gb.Gender,
  gb.GameGenre,
  COUNT(*) AS num_players,
 gb.EngagementLevel AS avg_engagement,
 gb.GameDifficulty AS avg_difficulty
FROM gaming_behavior gb
GROUP BY gb.Gender, gb.GameGenre
ORDER BY gb.Gender;
