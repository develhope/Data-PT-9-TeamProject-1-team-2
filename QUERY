-- Selezione dati demografici dei giocatori
WITH Demographics AS (
SELECT PlayerID, Age, Gender, Location
FROM gaming_behavior),
--Selezione informazioni comportamentali
Behavior AS (SELECT PlayerID, PlayTimeHours, AvgSessionDurationMinutes, SessionsPerWeek
FROM gaming_behavior),
-- Selezione statistiche di gioco
Stats  AS (SELECT PlayerID, PlayerLevel, AchievementsUnlocked
FROM gaming_behavior),
-- Selezione dati relativi al tasso di partecipazione e acquisti in game
Rate AS (SELECT PlayerID, InGamePurchases, EngagementLevel, GameGenre, GameDifficulty 
FROM gaming_behavior)
--Confronto tra i dati indicati per evidenziare la correlazione tra gli acquisti, la durata media di gioco, l'et√† e gli achievement sbloccati
SELECT b.PlayerID, s.AchievementsUnlocked , b.AvgSessionDurationMinutes, d.Age, r.IngamePurchases
FROM Behavior b 
JOIN Stats s on b.PlayerID = s.PlayerID
JOIN Demographics d on b.PlayerID = d.PlayerID
JOIN Rate r on b.PlayerID = r.PlayerID
ORDER BY s.AchievementsUnlocked DESC, r.InGamePurchases DESC;



SELECT
  Gender,
  GameGenre,
  COUNT(*) AS num_players,
 EngagementLevel AS avg_engagement,
 GameDifficulty AS avg_difficulty
FROM gaming_behavior 
GROUP BY Gender, GameGenre
ORDER BY Gender;
